#!/bin/bash

# Function to display CPU information
cpu_getinfo() {
    lscpu
}

# Function to display memory information
memory_getinfo() {
    free
}

# Function to create a new user
user_create() {
    if [ -z "$1" ]; then
        echo "Error: Please provide a username."
        exit 1
    fi

    sudo adduser "$1"
}

# Function to list regular users or sudo users
user_list() {
    if [ "$1" == "--sudo-only" ]; then
        sudo getent passwd | cut -d: -f1
    else
        getent passwd | cut -d: -f1
    fi
}

# Function to get file information
file_getinfo() {
    if [ -z "$2" ]; then
        echo "Error: Please provide a file name."
        exit 1
    fi

    case "$1" in
        "--size" | "-s")
            stat --format="%s" "$2"
            ;;
        "--permissions" | "-p")
            stat --format="%A" "$2"
            ;;
        "--owner" | "-o")
            stat --format="%U" "$2"
            ;;
        "--last-modified" | "-m")
            stat --format="%y" "$2"
            ;;
        *)
            # Default: Display comprehensive file information
            stat "$2"
            ;;
    esac
}

# Main script
case "$1" in
    "cpu")
        case "$2" in
            "getinfo")
                cpu_getinfo
                ;;
            *)
                echo "Error: Invalid CPU command."
                exit 1
                ;;
        esac
        ;;
    "memory")
        case "$2" in
            "getinfo")
                memory_getinfo
                ;;
            *)
                echo "Error: Invalid memory command."
                exit 1
                ;;
        esac
        ;;
    "user")
        case "$2" in
            "create")
                user_create "$3"
                ;;
            "list")
                user_list "$3"
                ;;
            *)
                echo "Error: Invalid user command."
                exit 1
                ;;
        esac
        ;;
    "file")
        shift
        file_getinfo "$@"
        ;;
    "--help" | "-h")
        # Display help information
        echo "Usage: internsctl [command] [subcommand] [options]"
        # Add more detailed help information if needed
        ;;
    "--version")
        # Display version information
        echo "internsctl v0.1.0"
        ;;
    *)
        echo "Error: Invalid command."
        exit 1
        ;;
esac
